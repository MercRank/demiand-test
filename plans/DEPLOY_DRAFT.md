# üöÄ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é (Deployment Guide)

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è RAG-–∞–≥–µ–Ω—Ç–∞ (Telegram-–±–æ—Ç + –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å + Qdrant) –Ω–∞ Linux-—Å–µ—Ä–≤–µ—Ä–µ (Ubuntu/Debian).

## üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

–ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å:

1.  **VPS/–í—ã–¥–µ–ª–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä**:
    *   **–û–°**: Ubuntu 20.04 LTS –∏–ª–∏ 22.04 LTS (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è).
    *   **CPU**: –ú–∏–Ω–∏–º—É–º 2 —è–¥—Ä–∞.
    *   **RAM**: –ú–∏–Ω–∏–º—É–º 4 –ì–ë (Qdrant –∏ ML-–±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –º–æ–≥—É—Ç –ø–æ—Ç—Ä–µ–±–ª—è—Ç—å –º–Ω–æ–≥–æ –ø–∞–º—è—Ç–∏).
    *   **Disk**: 20 –ì–ë+ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞.
2.  **–î–æ—Å—Ç—É–ø—ã**:
    *   SSH-–¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É —Å –ø—Ä–∞–≤–∞–º–∏ `root` –∏–ª–∏ `sudo`.
    *   API Key –æ—Ç OpenAI.
    *   –¢–æ–∫–µ–Ω Telegram-–±–æ—Ç–∞ (–æ—Ç @BotFather).

---

## üõ† –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

–û–±–Ω–æ–≤–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –ø–∞–∫–µ—Ç–æ–≤ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —É—Ç–∏–ª–∏—Ç—ã:

```bash
sudo apt update && sudo apt upgrade -y
sudo apt install -y git curl
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker –∏ Docker Compose

–ï—Å–ª–∏ Docker –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É (–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏):

```bash
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
```

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Docker –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫—É:

```bash
sudo systemctl start docker
sudo systemctl enable docker
```

–î–æ–±–∞–≤—å—Ç–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É docker (—á—Ç–æ–±—ã –Ω–µ –ø–∏—Å–∞—Ç—å `sudo` –∫–∞–∂–¥—ã–π —Ä–∞–∑):

```bash
sudo usermod -aG docker $USER
# –ü–æ—Å–ª–µ —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥—ã –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–ª–æ–≥–∏–Ω–∏—Ç—å—Å—è (–≤—ã–π—Ç–∏ –∏ –∑–∞–π—Ç–∏ –ø–æ SSH)
```

---

## üì¶ –®–∞–≥ 2: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

1.  **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π** –≤ –ø–∞–ø–∫—É `/opt` –∏–ª–∏ –¥–æ–º–∞—à–Ω—é—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é:

    ```bash
    cd ~
    git clone <URL_–í–ê–®–ï–ì–û_–†–ï–ü–û–ó–ò–¢–û–†–ò–Ø> rag-agent
    cd rag-agent
    ```

2.  **–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**:

    –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

    ```bash
    cp .env.example .env
    ```

3.  **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ .env**:

    –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `nano`):

    ```bash
    nano .env
    ```

    –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è:

    ```ini
    OPENAI_API_KEY=sk-proj-...          # –í–∞—à –∫–ª—é—á OpenAI
    TELEGRAM_BOT_TOKEN=123456:ABC...    # –¢–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
    QDRANT_URL=http://qdrant:6333       # –û—Å—Ç–∞–≤—å—Ç–µ –∫–∞–∫ –µ—Å—Ç—å –¥–ª—è Docker
    QDRANT_API_KEY=                     # –ú–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ Docker
    COLLECTION_NAME=knowledge_base      # –ò–º—è –∫–æ–ª–ª–µ–∫—Ü–∏–∏ (–º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
    ```

    *–ù–∞–∂–º–∏—Ç–µ `Ctrl+O`, `Enter` –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ `Ctrl+X` –¥–ª—è –≤—ã—Ö–æ–¥–∞.*

---

## üöÄ –®–∞–≥ 3: –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ —Å –ø–æ–º–æ—â—å—é Docker Compose:

```bash
docker compose up --build -d
```

*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –ï—Å–ª–∏ —É –≤–∞—Å —Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è Docker Compose, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É `docker-compose` –≤–º–µ—Å—Ç–æ `docker compose`.*

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 3 –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞: `qdrant`, `admin_ui`, `bot`):

```bash
docker compose ps
```

–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ (–µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç):

```bash
docker compose logs -f
```

---

## üåê –®–∞–≥ 4: –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å–∞–º

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å—ã –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –∞–¥—Ä–µ—Å–∞–º:

1.  **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (Streamlit)**: `http://<IP-–í–ê–®–ï–ì–û-–°–ï–†–í–ï–†–ê>:8501`
    *   –ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–≥—Ä—É–∂–∞—Ç—å Excel-—Ñ–∞–π–ª—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π.
2.  **Telegram –ë–æ—Ç**: –ü—Ä–æ—Å—Ç–æ –Ω–∞–π–¥–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ –≤ Telegram –∏ –Ω–∞–∂–º–∏—Ç–µ `/start`.
3.  **Qdrant Dashboard**: `http://<IP-–í–ê–®–ï–ì–û-–°–ï–†–í–ï–†–ê>:6333/dashboard`

---

## üõ°Ô∏è –®–∞–≥ 5: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ—Ä—Ç—ã 8501 –∏ 6333 –æ—Ç–∫—Ä—ã—Ç—ã –¥–ª—è –≤—Å–µ–≥–æ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞. –î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω-—Å—Ä–µ–¥—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–∫—Ä—ã—Ç—å –∏—Ö —Ñ–∞–µ—Ä–≤–æ–ª–æ–º –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Nginx —Å Basic Auth.

### –ü—Ä–æ—Å—Ç–∞—è –∑–∞—â–∏—Ç–∞ —Å UFW (Firewall)

–†–∞–∑—Ä–µ—à–∏—Ç–µ —Ç–æ–ª—å–∫–æ SSH –∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ—Ä—Ç—ã (–µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Nginx):

```bash
sudo ufw allow 22/tcp
sudo ufw allow 8501/tcp
sudo ufw enable
```

### (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx + SSL (HTTPS)

–î–ª—è –∑–∞—â–∏—Ç—ã –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –ø–∞—Ä–æ–ª–µ–º –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è HTTPS:

1.  –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Nginx: `sudo apt install nginx`
2.  –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å 80 –ø–æ—Ä—Ç–∞ –Ω–∞ 8501.
3.  –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `certbot` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞.

---

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ß—Ç–æ–±—ã –æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–µ–∫—Ç –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏ –∫–æ–¥–∞:

```bash
cd ~/rag-agent
git pull
docker compose up --build -d
```

## üóëÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —É–¥–∞–ª–µ–Ω–∏–µ

–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã:
```bash
docker compose stop
```

–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (–¥–∞–Ω–Ω—ã–µ –≤ Qdrant —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è –≤ volume):
```bash
docker compose down
```

–ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ (–í–ù–ò–ú–ê–ù–ò–ï: —É–¥–∞–ª–∏—Ç –±–∞–∑—É –∑–Ω–∞–Ω–∏–π):
```bash
docker compose down -v
```
